<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
html,body{height:100%;width:100%;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;overflow-x:hidden;}
body{display:flex;justify-content:center;align-items:center;padding:0;}

#spiderCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;}

.container{
  position:relative;
  z-index:1;
  width:100%;
  max-width:900px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  padding:15px;
}

/* Card styling */
.card{
  background:rgba(255,255,255,0.07);
  backdrop-filter:blur(20px);
  border-radius:20px;
  padding:25px;
  margin-bottom:20px;
  box-shadow:0 15px 40px rgba(0,0,0,0.5);
  width:100%;
  max-width:700px;
  transition: all 0.3s ease;
}
h2,h3,h4{margin-bottom:20px;font-weight:600;text-align:center;}
.info-box{margin-bottom:20px;line-height:1.8;font-size:16px;}
input,select{width:100%;padding:12px 15px;margin:8px 0;border:none;border-radius:12px;background:rgba(255,255,255,0.1);color:#fff;font-size:14px;}
input::placeholder{color:#ddd;}
select option{background:#203a43;color:#fff;}

/* Password eye toggle */
.password-wrapper{position:relative;}
.password-wrapper input{padding-right:45px;}
.password-wrapper .toggle-password{
  position:absolute;
  top:50%;
  right:12px;
  transform:translateY(-50%);
  background:none;
  border:none;
  cursor:pointer;
  width:22px;
  height:22px;
}

/* Buttons */
button{display:block;margin:15px auto;padding:12px 25px;border:none;border-radius:12px;background:linear-gradient(45deg,#00f2fe,#4facfe);color:white;cursor:pointer;transition:0.3s;font-weight:500;}
button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.4);}
.logout-btn{background:linear-gradient(45deg,#ff512f,#dd2476);}

/* Tables */
.table-wrapper-vertical{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;margin-top:15px;background:rgba(255,255,255,0.05);border-radius:12px;max-height:350px;}
.table-wrapper-vertical table{width:100%;border-collapse:collapse;min-width:400px;}
th,td{padding:8px;text-align:center;font-size:13px;}
th{background:rgba(255,255,255,0.1);}
tr:nth-child(even){background:rgba(255,255,255,0.05);}
.badge{padding:5px 10px;border-radius:20px;font-size:12px;font-weight:500;}
.present{background:#00c853;}
.absent{background:#d50000;}
.hidden{display:none;}

/* Student panel */
#studentPanel .card{max-width:700px;width:100%;margin:10px auto;}

/* Admin panel top margin */
#adminPanel{margin-top:70px;width:100%;display:flex;flex-direction:column;align-items:center;}

/* Responsive */
@media (max-width:1024px){.card{max-width:90%;}}
@media (max-width:768px){
  .card{padding:18px;}
  input,select,button{font-size:13px;}
  th,td{padding:6px;font-size:12px;}
  #adminPanel{margin-top:40px;}
}
@media (max-width:480px){
  body{padding:10px;}
  .card{padding:15px;border-radius:15px;}
  h2,h3,h4{font-size:17px;}
  input,select,button{font-size:12px;padding:10px;}
  th,td{padding:4px;font-size:11px;}
  #adminPanel{margin-top:20px;}
}
</style>
</head>
<body>

<canvas id="spiderCanvas"></canvas>

<div class="container">

<!-- LOGIN -->
<div id="loginSection" class="card login-box">
<h2>Attendance Portal</h2>
<input type="text" id="username" placeholder="Username">
<div class="password-wrapper">
  <input type="password" id="password" placeholder="Password">
  <button type="button" class="toggle-password" onclick="togglePassword()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 12c-2.8 0-5-2.2-5-5s2.2-5 5-5 5 2.2 5 5-2.2 5-5 5z"/><circle cx="12" cy="12" r="2.5"/></svg>
  </button>
</div>
<button onclick="login()">Login</button>
</div>

<!-- STUDENT PANEL -->
<div id="studentPanel" class="hidden">
<div class="card">
<h3>Student Dashboard</h3>
<div class="info-box">
<p><strong>Name:</strong> <span id="studentName"></span></p>
<p><strong>Class:</strong> <span id="studentClass"></span></p>
<p><strong>Roll No:</strong> <span id="studentRoll"></span></p>
</div>
<select id="statusSelect">
<option value="Present">Present</option>
<option value="Absent">Absent</option>
</select>
<button onclick="markAttendance()">Submit Attendance</button>
<div class="table-wrapper-vertical">
<table id="studentTable">
<tr><th>Date</th><th>Time</th><th>Status</th></tr>
</table>
</div>
<button class="logout-btn" onclick="logout()">Logout</button>
</div>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="hidden">
<div class="card"><h2>Admin Panel</h2></div>
<div class="card">
<h4>Add Student</h4>
<input type="text" id="newStudent" placeholder="Student Username">
<input type="password" id="newPass" placeholder="Password">
<input type="number" id="newRoll" placeholder="Roll No">
<select id="newClass">
<option value="">Select Class</option>
<option>ICS</option><option>ICOM</option><option>FA</option><option>FSC</option>
</select>
<button onclick="addStudent()">Add Student</button>
</div>
<div class="card">
<h4>Students By Class</h4>
<select id="classFilterStudents" onchange="loadStudentsByClass()">
<option value="">Select Class</option>
<option>ICS</option><option>ICOM</option><option>FA</option><option>FSC</option>
</select>
<div class="table-wrapper-vertical">
<table id="studentsTable">
<tr><th>Class</th><th>Roll No</th><th>Name</th><th>Action</th></tr>
</table>
</div>
</div>
<div class="card">
<h4>Attendance Report</h4>
<select id="classFilterAttendance" onchange="loadAttendance()">
<option value="all">All</option><option>ICS</option><option>ICOM</option><option>FA</option><option>FSC</option>
</select>
<div class="table-wrapper-vertical">
<table id="adminTable">
<tr><th>Name</th><th>Class</th><th>Roll No</th><th>Date</th><th>Time</th><th>Status</th></tr>
</table>
</div>
<button onclick="downloadReport()">Download CSV</button>
</div>
<button class="logout-btn" onclick="logout()">Logout</button>
</div>

</div>

<script>
/* Spider Animation */
const canvas=document.getElementById("spiderCanvas");
const ctx=canvas.getContext("2d");
function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;}
resizeCanvas();window.addEventListener("resize",resizeCanvas);
let particles=[];const particleCount=80;const connectDistance=120;
for(let i=0;i<particleCount;i++){particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,vx:(Math.random()-0.5),vy:(Math.random()-0.5)});}
function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);for(let i=0;i<particles.length;i++){let p=particles[i];p.x+=p.vx;p.y+=p.vy;if(p.x<0||p.x>canvas.width)p.vx*=-1;if(p.y<0||p.y>canvas.height)p.vy*=-1;ctx.beginPath();ctx.arc(p.x,p.y,2,0,Math.PI*2);ctx.fillStyle="white";ctx.fill();}
for(let i=0;i<particles.length;i++){for(let j=i+1;j<particles.length;j++){let dx=particles[i].x-particles[j].x;let dy=particles[i].y-particles[j].y;let dist=Math.sqrt(dx*dx+dy*dy);if(dist<connectDistance){ctx.beginPath();ctx.moveTo(particles[i].x,particles[i].y);ctx.lineTo(particles[j].x,particles[j].y);ctx.strokeStyle=`rgba(255,255,255,${0.1+0.2*(connectDistance-dist)/connectDistance})`;ctx.lineWidth=1;ctx.stroke();}}}
requestAnimationFrame(animate);}
animate();

/* LocalStorage & login */
if(!localStorage.getItem("users")){localStorage.setItem("users",JSON.stringify([{username:"admin",password:"admin123",role:"admin"}]));}
if(!localStorage.getItem("attendance")){localStorage.setItem("attendance",JSON.stringify([]));}

/* Toggle password eye */
function togglePassword(){
  const pwd=document.getElementById("password");
  pwd.type=pwd.type==="password"?"text":"password";
}

/* Login / Logout / Add Student / Attendance Functions */
function login(){
let users=JSON.parse(localStorage.getItem("users"));
let found=users.find(u=>u.username===username.value.trim()&&u.password===password.value.trim());
if(!found){alert("Invalid Login");return;}
localStorage.setItem("currentUser",JSON.stringify(found));
loginSection.classList.add("hidden");
if(found.role==="admin"){adminPanel.classList.remove("hidden");}
else{studentPanel.classList.remove("hidden");studentName.innerText=found.username;studentClass.innerText=found.className;studentRoll.innerText=found.rollNo;loadStudentAttendance();}
}
function logout(){localStorage.removeItem("currentUser");location.reload();}
function addStudent(){let users=JSON.parse(localStorage.getItem("users"));users.push({username:newStudent.value,password:newPass.value,rollNo:newRoll.value,className:newClass.value,role:"student"});localStorage.setItem("users",JSON.stringify(users));alert("Student Added");newStudent.value="";newPass.value="";newRoll.value="";newClass.value="";if(classFilterStudents.value) loadStudentsByClass();}
function loadStudentsByClass(){let selected=classFilterStudents.value;let users=JSON.parse(localStorage.getItem("users"));studentsTable.innerHTML="<tr><th>Class</th><th>Roll No</th><th>Name</th><th>Action</th></tr>";users.filter(u=>u.role==="student"&&u.className===selected).forEach(u=>{studentsTable.innerHTML+=`<tr><td>${u.className}</td><td>${u.rollNo}</td><td>${u.username}</td><td><button onclick="deleteStudent('${u.username}')">Delete</button></td></tr>`;});}
function deleteStudent(username){let users=JSON.parse(localStorage.getItem("users"));users=users.filter(u=>u.username!==username);localStorage.setItem("users",JSON.stringify(users));loadStudentsByClass();}
function markAttendance(){let user=JSON.parse(localStorage.getItem("currentUser"));let attendance=JSON.parse(localStorage.getItem("attendance"));let now=new Date();attendance.push({username:user.username,rollNo:user.rollNo,className:user.className,date:now.toLocaleDateString(),time:now.toLocaleTimeString(),status:statusSelect.value});localStorage.setItem("attendance",JSON.stringify(attendance));loadStudentAttendance();}
function loadStudentAttendance(){let user=JSON.parse(localStorage.getItem("currentUser"));let attendance=JSON.parse(localStorage.getItem("attendance"));studentTable.innerHTML="<tr><th>Date</th><th>Time</th><th>Status</th></tr>";attendance.filter(a=>a.username===user.username).forEach(a=>{let badge=a.status==="Present"?"present":"absent";studentTable.innerHTML+=`<tr><td>${a.date}</td><td>${a.time}</td><td><span class="badge ${badge}">${a.status}</span></td></tr>`;});}
function loadAttendance(){let selected=classFilterAttendance.value;let attendance=JSON.parse(localStorage.getItem("attendance"));adminTable.innerHTML="<tr><th>Name</th><th>Class</th><th>Roll No</th><th>Date</th><th>Time</th><th>Status</th></tr>";attendance.filter(a=>selected==="all"||a.className===selected).forEach(a=>{let badge=a.status==="Present"?"present":"absent";adminTable.innerHTML+=`<tr><td>${a.username}</td><td>${a.className}</td><td>${a.rollNo}</td><td>${a.date}</td><td>${a.time}</td><td><span class="badge ${badge}">${a.status}</span></td></tr>`;});}
function downloadReport(){let attendance=JSON.parse(localStorage.getItem("attendance"));let csv="Name,Class,Roll No,Date,Time,Status\n";attendance.forEach(a=>{csv+=`${a.username},${a.className},${a.rollNo},${a.date},${a.time},${a.status}\n`;});let blob=new Blob([csv],{type:"text/csv"});let url=window.URL.createObjectURL(blob);let a=document.createElement("a");a.href=url;a.download="attendance_report.csv";a.click();}
</script>

</body>
</html>
